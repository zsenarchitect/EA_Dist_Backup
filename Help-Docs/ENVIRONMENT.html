<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EnneadTab Documentation</title>
    <link rel="stylesheet" href="static/style.css">
</head>
<body>
    <div class="container">
        <nav class="sidebar">
            <h1>EnneadTab</h1>
            <div class="search-container">
                <input type="text" id="search" placeholder="Search documentation...">
                <div id="search-results"></div>
            </div>
            <div class="module-list">
                <!-- Module list will be populated by JavaScript -->
            </div>
        </nav>
        <main class="content">
            <h1>ENVIRONMENT</h1><p>Environment configuration and detection module for EnneadTab.

This module handles environment setup, path configurations, and runtime environment detection
for the EnneadTab ecosystem. It supports multiple applications including Revit, Rhino,
and terminal environments.

Key Features:
- Path configuration for development and production environments
- Application environment detection (Revit, Rhino, Grasshopper)
- System environment checks (AVD, Python version)
- Filesystem management for temp and dump folders
- Network drive availability monitoring

Note:
    Network drive connectivity is managed through GitHub distribution rather than 
    direct network mapping to optimize IT infrastructure costs.



Unfortunately IT department cannot make L drive and other drive to be connnected by default ever since the Azure dirve migration.
There are money to be saved to disconnect the drive, so we need to use github to push update to all users.

Dont tell me it is a security risk, it is NOT.</p><h2>Functions</h2>
                        <div class="function" id="_secure_folder">
                            <h3>_secure_folder(folder)</h3>
                            <p></p>
                        </div>
                        
                        <div class="function" id="cleanup_dump_folder">
                            <h3>cleanup_dump_folder()</h3>
                            <p>Clean up temporary files from the dump folder.

    Removes files older than 3 days from the DUMP_FOLDER, excluding protected file types:
    .json, PLUGIN_EXTENSION, .txt, .lock, and .rui files.
    
    This function runs silently and handles file deletion errors gracefully.</p>
                        </div>
                        
                        <div class="function" id="is_avd">
                            <h3>is_avd()</h3>
                            <p>Detect if running in Azure Virtual Desktop environment.

    Returns:
        bool: True if running in AVD or GPU-PD environment, False otherwise</p>
                        </div>
                        
                        <div class="function" id="is_Rhino_8">
                            <h3>is_Rhino_8()</h3>
                            <p>Check if current environment is Rhino 8.

    Returns:
        bool: True if running in Rhino 8, False otherwise</p>
                        </div>
                        
                        <div class="function" id="is_Rhino_7">
                            <h3>is_Rhino_7()</h3>
                            <p>Check if current environment is Rhino 7.

    Returns:
        bool: True if running in Rhino 7, False otherwise</p>
                        </div>
                        
                        <div class="function" id="get_rhino_version">
                            <h3>get_rhino_version(main_version_only=True)</h3>
                            <p>Retrieve the current Rhino version.

    Args:
        main_version_only (bool, optional): If True, returns only the major version number.
            Defaults to True.

    Returns:
        str or None: Rhino version number if in Rhino environment, None otherwise</p>
                        </div>
                        
                        <div class="function" id="is_Rhino_environment">
                            <h3>is_Rhino_environment()</h3>
                            <p>Check if the current environment is Rhino.

    Returns:
        bool: True if running in Rhino environment, False otherwise</p>
                        </div>
                        
                        <div class="function" id="is_Grasshopper_environment">
                            <h3>is_Grasshopper_environment()</h3>
                            <p>Check if current environment is Grasshopper.

    Returns:
        bool: True if running in Grasshopper environment, False otherwise</p>
                        </div>
                        
                        <div class="function" id="is_Revit_environment">
                            <h3>is_Revit_environment()</h3>
                            <p>Check if the current environment is Revit.

    Returns:
        bool: True if current environment is Revit.</p>
                        </div>
                        
                        <div class="function" id="is_RhinoInsideRevit_environment">
                            <h3>is_RhinoInsideRevit_environment()</h3>
                            <p>Check if the current environment is RhinoInsideRevit.

    Returns:
        bool: True if current environment is RhinoInsideRevit</p>
                        </div>
                        
                        <div class="function" id="is_terminal_environment">
                            <h3>is_terminal_environment()</h3>
                            <p>Check if the current environment is within the terminal.

    Returns:
        bool: True if current environment is a terminal.</p>
                        </div>
                        
                        <div class="function" id="unit_test">
                            <h3>unit_test()</h3>
                            <p></p>
                        </div>
                        
                        <div class="function" id="get_app_name">
                            <h3>get_app_name()</h3>
                            <p>Determine the current application environment.

    Returns:
        str: Application identifier - 'revit', 'rhino', or 'terminal'.</p>
                        </div>
                        
                        <div class="function" id="alert_l_drive_not_available">
                            <h3>alert_l_drive_not_available(play_sound = False)</h3>
                            <p>Check L drive availability and notify user if unavailable.

    Args:
        play_sound (bool): If True, plays an error sound when L drive is unavailable.

    Returns:
        bool: True if L drive is available, False otherwise.</p>
                        </div>
                        
        </main>
    </div>
    <script>
        const searchIndex = {{searchIndex}};
        // Initialize search functionality
        document.getElementById('search').addEventListener('input', function(e) {
            const query = e.target.value.toLowerCase();
            const results = searchIndex.filter(item => 
                item.title.toLowerCase().includes(query) || 
                item.content.toLowerCase().includes(query)
            );
            
            const resultsDiv = document.getElementById('search-results');
            resultsDiv.innerHTML = results.map(item => `
                <a href="${item.url}">${item.title}</a>
            `).join('');
        });
        
        // Populate module list
        const moduleList = document.querySelector('.module-list');
        const modules = [...new Set(searchIndex.map(item => item.url.split('/')[1].split('.')[0]))];
        moduleList.innerHTML = modules.map(module => `
            <a href="/${module}.html">${module}</a>
        `).join('');
    </script>
</body>
</html> 